---
description: 新機能を既存パターンに従って、完全に無停止で実装するワークフロー
---

# 新機能の追加 (完全自動実行モード)

**重要:** このワークフローは、ユーザーの介入なしに、開始から完了まで完全に自動で実行されるように設計されています。各ステップは完了後、ただちに次のステップへ移行してください。思考の途中でユーザーに確認を求めたり、作業を中断したりしないでください。

**引数:** 機能名 (例: `ユーザープロフィール編集機能の実装`)

---

## ステップ1: 準備とコンテキスト設定

1. 現在のタスクコンテキストを確立する:
  - 機能名: `[引数で与えられた機能名]`
  - 日付: `[現在の日付をYYYYMMDD形式で取得]`
  - ステアリングディレクトリパス: `.steering/[日付]-[機能名]/`
2. 上記ステアリングディレクトリを作成する。
3. 以下の3つの空ファイルを作成する:
  - `[ステアリングディレクトリパス]/requirements.md`
  - `[ステアリングディレクトリパス]/design.md`
  - `[ステアリングディレクトリパス]/tasklist.md`

## ステップ2: プロジェクト理解

1. プロジェクトのリポジトリルール (`rules.md` や `CLAUDE.md` など) を読み、プロジェクトの全体像を把握する。
2. `docs/` ディレクトリ等内の永続ドキュメントを確認し、関連する設計思想やアーキテクチャを理解する。

## ステップ3: 既存パターンの調査

1. Grep検索などの検索ツールを使用し、機能名に関連するキーワードでソースコード群を検索する。
2. 検索結果を分析し、既存の実装パターン、命名規則、コンポーネントの利用方法を特定する。

## ステップ4: 計画フェーズ (ステアリングファイルの自動生成)

1. `steering` スキル（またはステアリングファイルの作成ルール）を**計画モード**で実行し、ステップ1で作成した3つのファイル (`requirements.md`, `design.md`, `tasklist.md`) の内容を生成する。
2. **このステップが正常に完了したら、決して停止せず、ただちにステップ5に進むこと。**

## ステップ5: 実装ループ (tasklist.mdの完全消化)

**このステップは、`tasklist.md`の全タスクが `[x]` になるまで自動で繰り返されるループ処理です。**
**このステップが正常に完了したら、決して停止せず、ただちにステップ6に進むこと。**

**ループ開始:**

1. タスクリストの読み込み:
  - `[ステアリングディレクトリパス]/tasklist.md` ファイルを読み込む。
2. 進捗の確認:
  - ファイル内に未完了タスク (`[ ]`) が存在するか確認する。未完了タスクが存在しない場合は完了としステップ6へ進む。
3. タスクの実行:
  - 先頭の未完了タスクを特定し、実装作業を実行する。
4. タスクリストの更新:
  - 実行したタスクが完了したら、ファイル書き込みツールを使用して `[ ]` から `[x]` に変更する。
5. ループ継続:
  - 1に戻る。

※ タスクが大きすぎる場合はサブタスクに分割し、技術的理由で不要になった場合は `[x] ~~タスク名~~ (理由)` に更新してループを継続すること。

## ステップ6: 実装検証 (サブエージェント等の起動)

1. 全タスクの完了を最終確認する。
2. `implementation-validator` などの検証サブエージェント（または自身での検証フェーズ）を起動して品質を検証する。対象コードと該当する仕様書を突き合わせる。
3. **エラーがないことを確認し、ステップ7へ進むこと。**

## ステップ7: 自動テストの実行

1. プロジェクトに応じたビルド・テスト・Lintコマンド（例: `npm test`, `flutter test`, `pytest` 等）を実行し、問題ないか確認する。
2. エラーが発生した場合は問題を分析・修正し、再度テストを実行する。

## ステップ8: 振り返りとドキュメント更新

1. `steering` スキルの**振り返りモード**を実行し、`tasklist.md`に申し送り事項（実績、改善点等）を記載する。
2. プロジェクトの基本設計に影響がある場合、`docs/`内の関連する永続ドキュメントを更新する。

## 完了条件
全タスクの完了、検証のパス、テストの成功、振り返りの記載を満たした時点でワークフローは完了する。
